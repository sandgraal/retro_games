<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Dragon's Hoard Atlas - Video Game Collection Tracker</title>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta
      name="description"
      content="Track your video game collection with Dragon's Hoard Atlas. Manage owned games, wishlists, and backlogs across all platforms‚Äîretro classics, modern releases, indie gems, and more."
    />
    <meta
      name="keywords"
      content="video games, game collection, video game tracker, retro gaming, modern games, indie games, game database, collection management, PS5, Switch, Xbox, PC"
    />
    <meta name="author" content="Dragon's Hoard Atlas" />
    <meta name="robots" content="index, follow" />
    <link rel="canonical" href="https://sandgraal.github.io/retro-games/" />
    <link rel="manifest" href="./manifest.json" />

    <!-- Theme color for mobile browsers -->
    <meta name="theme-color" content="#00d4ff" />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta
      property="og:title"
      content="Dragon's Hoard Atlas - Video Game Collection Tracker"
    />
    <meta
      property="og:description"
      content="Track your video game collection with Dragon's Hoard Atlas. Manage owned games, wishlists, and backlogs across all platforms."
    />
    <meta
      property="og:image"
      content="https://sandgraal.github.io/retro-games/favicon.png"
    />
    <meta property="og:url" content="https://sandgraal.github.io/retro-games/" />
    <meta property="og:site_name" content="Dragon's Hoard Atlas" />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary" />
    <meta
      name="twitter:title"
      content="Dragon's Hoard Atlas - Video Game Collection Tracker"
    />
    <meta
      name="twitter:description"
      content="Track your video game collection with Dragon's Hoard Atlas. Manage owned games, wishlists, and backlogs across all platforms."
    />
    <meta
      name="twitter:image"
      content="https://sandgraal.github.io/retro-games/favicon.png"
    />

    <!-- Preconnect to external resources -->
    <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin />

    <!-- New Design System Styles -->
    <link rel="stylesheet" href="style.css" />

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="./favicon.png" />

    <!-- Preload critical resources -->
    <!-- Vite will handle module preloading in production -->

    <!-- Supabase -->
    <script
      src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"
      defer
    ></script>
  </head>
  <body>
    <!-- Skip Link for Accessibility -->
    <a class="skip-link" href="#mainContent">Skip to main content</a>

    <!-- App Shell -->
    <div class="app-shell">
      <!-- Sticky Header -->
      <header class="app-header" role="banner">
        <div class="header-content">
          <button
            type="button"
            class="app-logo"
            id="homeBtn"
            aria-label="Go to home page"
          >
            <span class="app-logo-icon" aria-hidden="true">üéÆ</span>
            <span>Dragon's Hoard Atlas</span>
          </button>

          <div class="header-search">
            <span class="header-search-icon" aria-hidden="true">üîç</span>
            <input
              type="search"
              id="headerSearch"
              class="header-search-input"
              placeholder="Search games..."
              aria-label="Search games"
              autocomplete="off"
            />
          </div>

          <div class="header-actions">
            <button
              type="button"
              class="header-action-btn header-action-btn--random"
              id="randomGameBtn"
              aria-label="Discover a random game"
              title="Random Game (R)"
            >
              <span aria-hidden="true">üé≤</span>
            </button>
            <button
              type="button"
              class="header-action-btn"
              id="guidesBtn"
              aria-label="Collecting guides"
              title="Collecting Guides"
            >
              <span aria-hidden="true">üìñ</span>
            </button>
            <button
              type="button"
              class="header-action-btn header-action-btn--mod"
              id="moderationBtn"
              aria-label="Moderation queue"
              title="Moderation Queue"
              hidden
            >
              <span aria-hidden="true">üõ°Ô∏è</span>
            </button>
            <button
              type="button"
              class="header-action-btn"
              id="exportBtn"
              aria-label="Export collection to CSV"
              title="Export to CSV"
            >
              <span aria-hidden="true">üì§</span>
            </button>
            <button
              type="button"
              class="header-action-btn"
              id="shareBtn"
              aria-label="Share collection"
              title="Get Shareable Link"
            >
              <span aria-hidden="true">üîó</span>
            </button>
            <button
              type="button"
              class="header-action-btn"
              id="settingsBtn"
              aria-label="Settings"
              title="Settings"
            >
              <span aria-hidden="true">‚öôÔ∏è</span>
            </button>
            <button
              type="button"
              class="header-action-btn header-action-btn--auth"
              id="authBtn"
              aria-label="Sign in"
              title="Sign in with GitHub"
            >
              <span aria-hidden="true">üë§</span>
            </button>
          </div>
        </div>
      </header>

      <!-- Main Content -->
      <main id="mainContent" class="app-main" tabindex="-1">
        <!-- Hero Dashboard - Stats First -->
        <section class="hero-dashboard" aria-label="Collection dashboard">
          <div class="dashboard-hero-content">
            <h2 class="dashboard-title">Your Hoard Ledger at a Glance</h2>
            <p class="dashboard-subtitle">
              Track your games, build wishlists, manage your backlog. All data stays on
              your device‚Äîno account needed. Export anytime.
            </p>
            <div class="dashboard-grid" id="dashboardGrid">
              <!-- Owned Games Card -->
              <div class="stat-card">
                <div class="stat-card-header">
                  <span class="stat-card-icon" aria-hidden="true">üéÆ</span>
                </div>
                <div class="stat-card-label">Owned Games</div>
                <div class="stat-card-value accent-primary" id="ownedCount">0</div>
                <div class="stat-card-subtitle" id="ownedPlatformBreakdown">
                  Loading...
                </div>
                <div class="stat-progress">
                  <div class="stat-progress-bar">
                    <div
                      class="stat-progress-fill"
                      style="width: 0%"
                      id="ownedProgressBar"
                    ></div>
                  </div>
                </div>
              </div>

              <!-- Collection Value Card -->
              <div class="stat-card">
                <div class="stat-card-header">
                  <span class="stat-card-icon" aria-hidden="true">üí∞</span>
                </div>
                <div class="stat-card-label">Collection Value</div>
                <div class="stat-card-value accent-warm" id="collectionValue">$0</div>
                <div class="stat-card-trend" id="valueTrend">
                  <span aria-hidden="true">‚Üó</span>
                  <span>Calculating...</span>
                </div>
              </div>

              <!-- Hot Deals Card -->
              <div class="stat-card stat-card--deals">
                <div class="stat-card-header">
                  <span class="stat-card-icon" aria-hidden="true">üî•</span>
                </div>
                <div class="stat-card-label">Hot Deals</div>
                <div class="stat-card-value accent-success" id="dealsCount">0</div>
                <div class="stat-card-deals" id="hotDealsCarousel">
                  <!-- Populated by JS -->
                </div>
              </div>

              <!-- Recent Additions Card -->
              <div class="stat-card">
                <div class="stat-card-header">
                  <span class="stat-card-icon" aria-hidden="true">‚ú®</span>
                </div>
                <div class="stat-card-label">Recent Additions</div>
                <div class="stat-card-value" id="recentCount">5</div>
                <div class="stat-card-carousel" id="recentGamesCarousel">
                  <!-- Populated by JS -->
                </div>
              </div>

              <!-- Wishlist Card -->
              <div class="stat-card">
                <div class="stat-card-header">
                  <span class="stat-card-icon" aria-hidden="true">‚≠ê</span>
                </div>
                <div class="stat-card-label">Wishlist</div>
                <div class="stat-card-value" id="wishlistCount">0</div>
                <div class="stat-card-subtitle" id="wishlistValue">Est. $0</div>
              </div>

              <!-- Backlog Card -->
              <div class="stat-card">
                <div class="stat-card-header">
                  <span class="stat-card-icon" aria-hidden="true">üìö</span>
                </div>
                <div class="stat-card-label">Backlog</div>
                <div class="stat-card-value" id="backlogCount">0</div>
                <div class="stat-card-subtitle" id="backlogHours">~0 hours</div>
              </div>

              <!-- Quick Actions Card -->
              <div class="stat-card">
                <div class="stat-card-header">
                  <span class="stat-card-icon" aria-hidden="true">‚ö°</span>
                </div>
                <div class="stat-card-label">Quick Actions</div>
                <div class="stat-card-carousel">
                  <button
                    type="button"
                    class="game-card-action"
                    id="importBtn"
                    aria-label="Import collection from Steam, PlayStation, Xbox, or other services"
                    title="Import from Steam, PSN, Xbox, etc."
                  >
                    Import
                  </button>
                  <button
                    type="button"
                    class="game-card-action"
                    id="backupBtn"
                    aria-label="Create a backup of your collection"
                    title="Download collection backup"
                  >
                    Backup
                  </button>
                  <button
                    type="button"
                    class="game-card-action"
                    id="contributeBtn"
                    aria-label="Suggest a correction or add missing data"
                    title="Help improve the database"
                  >
                    Contribute
                  </button>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- Curated Sections - Browsing Discovery -->
        <section
          id="curatedSections"
          class="curated-sections"
          aria-label="Curated game collections"
        >
          <!-- Populated by initCuratedSections() -->
        </section>

        <!-- Collection Grid with Filters -->
        <section class="collection-container" aria-label="Game collection">
          <!-- Filters Sidebar -->
          <aside class="filters-sidebar" id="filtersSidebar">
            <div class="filters-header">
              <h3 class="filters-title">Filters</h3>
              <span
                class="filters-match-count"
                id="matchCount"
                title="Games matching current filters"
                >0 games</span
              >
              <button type="button" class="filters-clear" id="clearFilters" disabled>
                Clear All
              </button>
              <button
                type="button"
                class="filters-share"
                id="shareFiltersBtn"
                title="Copy filter URL to share"
              >
                üîó
              </button>
            </div>

            <!-- Saved Filter Presets -->
            <div id="presetSelector"></div>

            <!-- Recently Viewed -->
            <div id="recentlyViewedSection"></div>

            <!-- Quick Filters -->
            <div class="quick-filters" id="quickFilters">
              <button
                type="button"
                class="quick-filter-btn"
                data-quick="popular"
                title="Top rated games"
              >
                üèÜ Popular
              </button>
              <button
                type="button"
                class="quick-filter-btn"
                data-quick="new"
                title="Recently released"
              >
                ‚ú® New
              </button>
              <button
                type="button"
                class="quick-filter-btn"
                data-quick="affordable"
                title="Games under $30"
              >
                üí∞ Under $30
              </button>
            </div>

            <!-- Search Filter -->
            <div class="filter-search">
              <span class="filter-search-icon" aria-hidden="true">üîç</span>
              <input
                type="search"
                id="filterSearch"
                class="filter-search-input"
                placeholder="Search..."
                aria-label="Filter by search"
              />
            </div>

            <!-- Platform Filter -->
            <details class="filter-group filter-group--collapsible" open>
              <summary class="filter-group-label filter-group-toggle">
                <span>Platform</span>
                <span class="filter-group-meta">
                  <span class="filter-count" id="platformCount">0</span>
                  <span class="filter-group-arrow">‚ñº</span>
                </span>
              </summary>
              <div class="filter-options filter-options--scrollable" id="platformFilters">
                <!-- Populated by JS -->
              </div>
            </details>

            <!-- Genre Filter -->
            <details class="filter-group filter-group--collapsible">
              <summary class="filter-group-label filter-group-toggle">
                <span>Genre</span>
                <span class="filter-group-meta">
                  <span class="filter-count" id="genreCount">0</span>
                  <span class="filter-group-arrow">‚ñº</span>
                </span>
              </summary>
              <div class="filter-options filter-options--scrollable" id="genreFilters">
                <!-- Populated by JS -->
              </div>
            </details>

            <!-- Region Filter -->
            <details class="filter-group filter-group--collapsible">
              <summary class="filter-group-label filter-group-toggle">
                <span>Region</span>
                <span class="filter-group-meta">
                  <span class="filter-count" id="regionCount">0</span>
                  <span class="filter-group-arrow">‚ñº</span>
                </span>
              </summary>
              <div class="filter-options" id="regionFilters">
                <label class="filter-option">
                  <input type="checkbox" value="NTSC" data-filter="region" />
                  <span class="filter-option-label">NTSC</span>
                  <span class="filter-option-count" data-region="NTSC">0</span>
                </label>
                <label class="filter-option">
                  <input type="checkbox" value="PAL" data-filter="region" />
                  <span class="filter-option-label">PAL</span>
                  <span class="filter-option-count" data-region="PAL">0</span>
                </label>
                <label class="filter-option">
                  <input type="checkbox" value="JPN" data-filter="region" />
                  <span class="filter-option-label">JPN</span>
                  <span class="filter-option-count" data-region="JPN">0</span>
                </label>
              </div>
            </details>

            <!-- Status Filter -->
            <div class="filter-group">
              <div class="filter-group-label">
                <span>Status</span>
                <span class="filter-count" id="statusCount">0</span>
              </div>
              <div class="filter-options" id="statusFilters">
                <label class="filter-option">
                  <input type="checkbox" value="owned" data-filter="status" />
                  <span class="filter-option-label">Owned</span>
                  <span class="filter-option-count" data-status="owned">0</span>
                </label>
                <label class="filter-option">
                  <input type="checkbox" value="wishlist" data-filter="status" />
                  <span class="filter-option-label">Wishlist</span>
                  <span class="filter-option-count" data-status="wishlist">0</span>
                </label>
                <label class="filter-option">
                  <input type="checkbox" value="backlog" data-filter="status" />
                  <span class="filter-option-label">Backlog</span>
                  <span class="filter-option-count" data-status="backlog">0</span>
                </label>
                <label class="filter-option">
                  <input type="checkbox" value="trade" data-filter="status" />
                  <span class="filter-option-label">For Trade</span>
                  <span class="filter-option-count" data-status="trade">0</span>
                </label>
              </div>
            </div>

            <!-- Era Filter -->
            <div class="filter-group">
              <div class="filter-group-label">
                <span>Era</span>
                <span class="filter-count" id="eraCount">0</span>
              </div>
              <div class="filter-options" id="eraFilters">
                <label class="filter-option">
                  <input type="checkbox" value="retro" data-filter="era" />
                  <span class="filter-option-label">Retro</span>
                  <span class="filter-option-count" data-era="retro">0</span>
                </label>
                <label class="filter-option">
                  <input type="checkbox" value="last-gen" data-filter="era" />
                  <span class="filter-option-label">Last Gen</span>
                  <span class="filter-option-count" data-era="last-gen">0</span>
                </label>
                <label class="filter-option">
                  <input type="checkbox" value="current" data-filter="era" />
                  <span class="filter-option-label">Current</span>
                  <span class="filter-option-count" data-era="current">0</span>
                </label>
              </div>
            </div>

            <!-- Special Filters -->
            <div class="filter-group">
              <div class="filter-group-label">
                <span>Special</span>
              </div>
              <div class="filter-options filter-toggles">
                <label class="filter-toggle">
                  <input type="checkbox" id="indieToggle" data-filter="indie" />
                  <span class="filter-toggle-label">üé® Indie Games Only</span>
                </label>
                <label class="filter-toggle">
                  <input type="checkbox" id="vrToggle" data-filter="vr" />
                  <span class="filter-toggle-label">ü•Ω VR Games Only</span>
                </label>
                <label class="filter-toggle">
                  <input type="checkbox" id="dealsToggle" data-filter="deals" />
                  <span class="filter-toggle-label">üí∞ On Sale</span>
                </label>
              </div>
            </div>

            <!-- Year Range Filter -->
            <div class="filter-group">
              <div class="filter-group-label">
                <span>Release Year</span>
              </div>
              <div class="filter-range" id="yearRange">
                <input
                  type="number"
                  id="yearStart"
                  class="filter-range-input"
                  placeholder="From"
                  min="1970"
                  max="2025"
                  aria-label="Year from"
                />
                <span class="filter-range-separator">‚Äì</span>
                <input
                  type="number"
                  id="yearEnd"
                  class="filter-range-input"
                  placeholder="To"
                  min="1970"
                  max="2025"
                  aria-label="Year to"
                />
              </div>
            </div>

            <!-- Minimum Rating Filter -->
            <div class="filter-group">
              <div class="filter-group-label">
                <span>Minimum Rating</span>
              </div>
              <div class="filter-slider" id="ratingFilter">
                <input
                  type="range"
                  id="ratingMin"
                  class="filter-range-slider"
                  min="0"
                  max="10"
                  step="0.5"
                  value="0"
                  aria-label="Minimum rating"
                />
                <span class="filter-range-value" id="ratingMinValue">0</span>
              </div>
            </div>

            <!-- Price Range Filter -->
            <div class="filter-group">
              <div class="filter-group-label">
                <span>Price Range</span>
              </div>
              <div class="filter-range" id="priceFilter">
                <input
                  type="number"
                  id="priceMin"
                  class="filter-range-input"
                  placeholder="$0"
                  min="0"
                  aria-label="Minimum price"
                />
                <span class="filter-range-separator">-</span>
                <input
                  type="number"
                  id="priceMax"
                  class="filter-range-input"
                  placeholder="$‚àû"
                  min="0"
                  aria-label="Maximum price"
                />
              </div>
            </div>

            <!-- Sort Options -->
            <div class="filter-group">
              <div class="filter-group-label">
                <span>Sort By</span>
              </div>
              <div class="filter-sort" id="sortOptions">
                <button type="button" class="sort-option active" data-sort="popularity">
                  Popularity
                </button>
                <button type="button" class="sort-option" data-sort="name">
                  Name (A-Z)
                </button>
                <button type="button" class="sort-option" data-sort="rating">
                  Rating (High to Low)
                </button>
                <button type="button" class="sort-option" data-sort="year">
                  Year (Newest First)
                </button>
                <button type="button" class="sort-option" data-sort="value">
                  Value (High to Low)
                </button>
              </div>
            </div>
          </aside>

          <!-- Game Grid -->
          <div class="game-grid" id="gameGrid">
            <!-- Populated by JS -->
            <div class="loading">
              <div class="loading-spinner"></div>
            </div>
          </div>
        </section>

        <!-- Guides Section (hidden by default) -->
        <section
          class="guides-container"
          id="guidesContainer"
          hidden
          aria-label="Collecting guides"
        >
          <!-- Populated by JS -->
        </section>

        <!-- Moderation Queue (hidden by default, moderators only) -->
        <section
          id="moderationPanel"
          class="moderation-container"
          hidden
          aria-label="Community moderation"
        ></section>
      </main>

      <!-- Mobile Navigation -->
      <nav class="mobile-nav" aria-label="Mobile navigation">
        <button type="button" class="mobile-nav-item active" data-nav="collection">
          <span class="mobile-nav-icon" aria-hidden="true">üéÆ</span>
          <span>Collection</span>
        </button>
        <button type="button" class="mobile-nav-item filters-toggle" id="filtersToggle">
          <span class="mobile-nav-icon" aria-hidden="true">üîß</span>
          <span>Filters</span>
        </button>
      </nav>

      <!-- Filters Backdrop (Mobile) -->
      <div class="filters-backdrop" id="filtersBackdrop"></div>
    </div>

    <!-- Game Detail Modal -->
    <div
      class="modal-backdrop"
      id="gameModalBackdrop"
      role="dialog"
      aria-modal="true"
      aria-labelledby="gameModalTitle"
      aria-hidden="true"
      hidden
    >
      <div class="modal" id="gameModal">
        <header class="modal-header">
          <h2 class="modal-title" id="gameModalTitle">Game Details</h2>
          <button
            type="button"
            class="modal-close"
            id="gameModalClose"
            aria-label="Close modal"
          >
            <span aria-hidden="true">√ó</span>
          </button>
        </header>
        <div class="modal-content">
          <div class="modal-cover" id="gameModalCover">
            <div class="modal-cover-image">
              <img src="" alt="" id="gameModalCoverImage" />
            </div>
            <div class="modal-cover-actions" id="gameModalActions">
              <!-- Status buttons populated by JS -->
            </div>
          </div>
          <div class="modal-info">
            <div class="modal-details" id="gameModalDetails">
              <!-- Game details populated by JS -->
            </div>
            <div class="modal-guides" id="gameModalGuides">
              <!-- Relevant guides populated by JS -->
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- SEO: Noscript fallback for crawlers -->
    <noscript>
      <div style="padding: 2rem; text-align: center; background: #14181f; color: #fff">
        <h1>Dragon's Hoard Atlas</h1>
        <p>
          Track your video game collection across all platforms‚Äîretro classics, modern
          releases, indie gems, and more.
        </p>
        <h2>Features</h2>
        <ul style="list-style: none; padding: 0">
          <li>üìä Collection Dashboard - Track owned games, wishlists, and backlogs</li>
          <li>üîç Advanced Search - Filter by platform, genre, rating, and region</li>
          <li>üí∞ Price Tracking - Monitor collection value</li>
          <li>üì§ Export & Share - CSV export and shareable collection codes</li>
          <li>üéÆ 32,000+ Games - Comprehensive game database</li>
        </ul>
        <p>Enable JavaScript to use the full application.</p>
      </div>
    </noscript>

    <!-- Load Config (external, not bundled) -->
    <script type="module">
      // Dynamic config loading
      try {
        const script = document.createElement("script");
        script.src = "config.js";
        document.head.appendChild(script);
      } catch (e) {
        console.warn("Config not found, using sample data");
      }
    </script>

    <!-- Load App (Vite handles this in dev, builds to dist in prod) -->
    <script type="module" src="/src/main.ts"></script>
  </body>
</html>
