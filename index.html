<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Sandgraal's Game List</title>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link rel="stylesheet" href="style.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap"
      rel="stylesheet"
    />
    <link rel="icon" type="image/png" href="/favicon.png" />
    <script
      src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"
      defer
    ></script>
  </head>
  <body>
    <div class="app-shell">
      <header class="app-hero">
        <div class="hero-copy">
          <h1>Sandgraal's Game List</h1>
          <p class="hero-subtitle">
            Curate, track, and share your retro collection without losing the weekend to
            spreadsheets.
          </p>
        </div>
        <div class="actions-toolbar" role="toolbar" aria-label="Collection actions">
          <div class="toolbar-group toolbar-group-primary">
            <button id="exportBtn" class="primary-action">Export Owned Games</button>
            <button id="shareBtn" class="primary-action">Get Shareable Link</button>
          </div>
          <div class="toolbar-group toolbar-group-secondary">
            <button id="showImport">Import Collection Code</button>
            <button id="backupBtn">Backup Collection JSON</button>
            <button id="restoreBtn">Restore Backup</button>
            <input
              type="file"
              id="restoreInput"
              accept="application/json"
              style="display: none"
            />
          </div>
        </div>
      </header>
      <section
        id="trendingPicks"
        class="trending-section"
        aria-label="Trending picks from your library"
      >
        <div class="trending-header">
          <h2>Trending Picks</h2>
          <p class="trending-subtitle">
            Highest-rated gems and fresh additions worth another look.
          </p>
        </div>
        <div class="trending-carousel">
          <button
            type="button"
            class="carousel-control prev"
            data-carousel-target="trendingWindow"
            data-direction="prev"
            aria-label="Scroll to previous trending picks"
          >
            <span aria-hidden="true">&#10094;</span>
          </button>
          <div
            id="trendingWindow"
            class="trending-window"
            data-carousel-window
            tabindex="0"
          >
            <div id="trendingList" class="trending-list" role="list"></div>
          </div>
          <button
            type="button"
            class="carousel-control next"
            data-carousel-target="trendingWindow"
            data-direction="next"
            aria-label="Scroll to next trending picks"
          >
            <span aria-hidden="true">&#10095;</span>
          </button>
        </div>
      </section>
      <section class="filters-panel" aria-label="Collection filters">
        <div class="filters primary-filters">
          <label class="filter-field">
            <span>Platform</span>
            <select id="platformFilter">
              <option value="">All Platforms</option>
            </select>
          </label>
          <label class="filter-field">
            <span>Genre</span>
            <select id="genreFilter">
              <option value="">All Genres</option>
            </select>
          </label>
          <label class="filter-field search-field">
            <span>Search</span>
            <div class="typeahead-field">
              <input
                id="search"
                placeholder="Type to filter..."
                aria-autocomplete="list"
                aria-controls="searchSuggestions"
                aria-expanded="false"
                autocomplete="off"
              />
              <div
                id="searchSuggestions"
                class="typeahead-panel"
                role="listbox"
                aria-label="Suggested games"
                hidden
              ></div>
            </div>
          </label>
          <label class="filter-field">
            <span>Sort</span>
            <select id="sortControl">
              <option value="name-asc">Name (A → Z)</option>
              <option value="name-desc">Name (Z → A)</option>
              <option value="rating-desc">Rating (High → Low)</option>
              <option value="rating-asc">Rating (Low → High)</option>
              <option value="year-desc">Release (New → Old)</option>
              <option value="year-asc">Release (Old → New)</option>
            </select>
          </label>
        </div>
        <details class="filters-advanced" open>
          <summary>Advanced filters</summary>
          <div class="filters advanced-filters">
            <label class="filter-field">
              <span>Status</span>
              <select id="statusFilter">
                <option value="">All Statuses</option>
                <option value="owned">Owned</option>
                <option value="wishlist">Wishlist</option>
                <option value="backlog">Backlog</option>
                <option value="trade">Trade</option>
              </select>
            </label>
            <label class="filter-field">
              <span>Min Rating</span>
              <input
                id="ratingFilter"
                type="number"
                inputmode="decimal"
                min="0"
                max="10"
                step="0.1"
                placeholder="0-10"
              />
            </label>
            <label class="filter-field">
              <span>Year From</span>
              <input
                id="yearStartFilter"
                type="number"
                inputmode="numeric"
                placeholder="1985"
              />
            </label>
            <label class="filter-field">
              <span>Year To</span>
              <input
                id="yearEndFilter"
                type="number"
                inputmode="numeric"
                placeholder="2005"
              />
            </label>
            <button id="clearFilters" class="filter-field clear-button">
              Clear Filters
            </button>
          </div>
        </details>
      </section>
      <div id="stats">Loading stats...</div>
      <section id="dashboard" aria-label="Collection dashboard">
        <div class="dashboard-card" id="dashboard-statuses">
          <h2>Status Mix</h2>
          <div class="status-progress" role="list">
            <div class="status-row" role="listitem">
              <div class="status-label">
                <span class="status-name">Owned</span>
                <span class="status-metric">
                  <strong id="dash-owned-count">0</strong>
                  <span id="dash-owned-percent" class="status-percent">0%</span>
                </span>
              </div>
              <div
                class="status-bar"
                role="progressbar"
                aria-valuemin="0"
                aria-valuemax="100"
                aria-valuenow="0"
                aria-label="Owned games in collection"
              >
                <span id="dash-owned-bar" class="status-bar-fill"></span>
              </div>
            </div>
            <div class="status-row" role="listitem">
              <div class="status-label">
                <span class="status-name">Wishlist</span>
                <span class="status-metric">
                  <strong id="dash-wishlist-count">0</strong>
                  <span id="dash-wishlist-percent" class="status-percent">0%</span>
                </span>
              </div>
              <div
                class="status-bar"
                role="progressbar"
                aria-valuemin="0"
                aria-valuemax="100"
                aria-valuenow="0"
                aria-label="Wishlist games in collection"
              >
                <span id="dash-wishlist-bar" class="status-bar-fill"></span>
              </div>
            </div>
            <div class="status-row" role="listitem">
              <div class="status-label">
                <span class="status-name">Backlog</span>
                <span class="status-metric">
                  <strong id="dash-backlog-count">0</strong>
                  <span id="dash-backlog-percent" class="status-percent">0%</span>
                </span>
              </div>
              <div
                class="status-bar"
                role="progressbar"
                aria-valuemin="0"
                aria-valuemax="100"
                aria-valuenow="0"
                aria-label="Backlog games in collection"
              >
                <span id="dash-backlog-bar" class="status-bar-fill"></span>
              </div>
            </div>
            <div class="status-row" role="listitem">
              <div class="status-label">
                <span class="status-name">Trade</span>
                <span class="status-metric">
                  <strong id="dash-trade-count">0</strong>
                  <span id="dash-trade-percent" class="status-percent">0%</span>
                </span>
              </div>
              <div
                class="status-bar"
                role="progressbar"
                aria-valuemin="0"
                aria-valuemax="100"
                aria-valuenow="0"
                aria-label="Trade-ready games in collection"
              >
                <span id="dash-trade-bar" class="status-bar-fill"></span>
              </div>
            </div>
          </div>
        </div>
        <div class="dashboard-card" id="dashboard-valuation" aria-live="polite">
          <div class="valuation-header">
            <h2>Collection Value</h2>
            <button id="valuationRefresh" type="button" class="ghost-button">
              Refresh Prices
            </button>
          </div>
          <p id="valuationStatus" class="valuation-status">
            Connect a PriceCharting token to see live valuations.
          </p>
          <div class="valuation-grid" role="list">
            <div class="valuation-metric" role="listitem">
              <span>Owned</span>
              <strong id="valuation-owned">—</strong>
            </div>
            <div class="valuation-metric" role="listitem">
              <span>Wishlist</span>
              <strong id="valuation-wishlist">—</strong>
            </div>
            <div class="valuation-metric" role="listitem">
              <span>Backlog</span>
              <strong id="valuation-backlog">—</strong>
            </div>
            <div class="valuation-metric" role="listitem">
              <span>Trade</span>
              <strong id="valuation-trade">—</strong>
            </div>
            <div class="valuation-metric valuation-total" role="listitem">
              <span>Total</span>
              <strong id="valuation-total">—</strong>
            </div>
          </div>
          <div class="valuation-trend" aria-label="Collection value trend">
            <canvas id="valuationSparkline" width="320" height="100"></canvas>
          </div>
        </div>
        <div class="dashboard-card" id="dashboard-top-genres">
          <h2>Top Genres</h2>
          <div class="genre-carousel">
            <button
              type="button"
              class="carousel-control prev"
              data-carousel-target="dash-genres-window"
              data-direction="prev"
              aria-label="Scroll to previous top genres"
            >
              <span aria-hidden="true">&#10094;</span>
            </button>
            <div
              id="dash-genres-window"
              class="genre-window"
              data-carousel-window
              tabindex="0"
            >
              <div id="dash-genres" class="genre-track" role="list"></div>
            </div>
            <button
              type="button"
              class="carousel-control next"
              data-carousel-target="dash-genres-window"
              data-direction="next"
              aria-label="Scroll to next top genres"
            >
              <span aria-hidden="true">&#10095;</span>
            </button>
          </div>
        </div>
        <div class="dashboard-card" id="dashboard-release">
          <h2>Release Timeline</h2>
          <div id="dash-timeline" class="timeline-bars">Loading...</div>
        </div>
      </section>
      <section class="browse-toolbar" aria-label="Browse controls and pagination">
        <div class="browse-summary" id="browseSummary" aria-live="polite">
          Preparing collection view...
        </div>
        <div class="browse-controls">
          <label class="browse-control">
            <span>Browse Mode</span>
            <select id="browseModeSelect">
              <option value="stream">Infinite scroll</option>
              <option value="paged">Paginated</option>
            </select>
          </label>
          <label class="browse-control">
            <span>Batch Size</span>
            <select id="pageSizeSelect">
              <option value="30">30</option>
              <option value="60">60</option>
              <option value="120">120</option>
            </select>
          </label>
        </div>
      </section>
      <div id="shareSection" style="display: none">
        <button id="closeShare" title="Close">&times;</button>
        <div>
          <label for="shareCode">Share Code:</label>
          <input id="shareCode" readonly />
          <button id="copyShare">Copy</button>
        </div>
        <div>
          <label for="importCode">Import Code:</label>
          <input id="importCode" placeholder="Paste code here..." />
          <button id="importBtn">View</button>
          <span id="importResult"></span>
        </div>
      </div>
      <div id="result">Loading...</div>
      <div id="gameGrid" class="game-grid" aria-live="polite"></div>
      <nav
        id="paginationControls"
        class="pagination"
        aria-label="Game list pagination"
      ></nav>
      <button id="loadMoreBtn" class="load-more" type="button">Load more games</button>
      <div id="gridSentinel" class="grid-sentinel" aria-hidden="true"></div>
      <div id="modalBg"></div>
      <div id="gameModal"></div>
    </div>
    <script src="config.js" defer></script>
    <script src="app.js" defer></script>
  </body>
</html>
